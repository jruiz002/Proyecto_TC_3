# Máquina de Turing Alteradora
# Función: Duplicar una cadena
# Descripción: Toma una cadena w y la convierte en ww (duplicada)

mt:
  states: [q0, q1, q2, q3, q4, qf]
  input_alphabet: [a, b]
  tape_alphabet: [a, b, B, X, Y, Z]
  initial_state: q0
  accept_states: [qf]
  transitions:
    # Fase 1: Marcar el primer símbolo y copiarlo al final
    # Procesar 'a'
    - state: q0
      read: [a]
      write: [X]
      move: R
      next: q1
    
    # Procesar 'b'
    - state: q0
      read: [b]
      write: [Y]
      move: R
      next: q1
    
    # Si encontramos Z (separador), hemos terminado la primera copia
    - state: q0
      read: [Z]
      write: [Z]
      move: R
      next: q4
    
    # Fase 2: Ir al final de la cadena
    - state: q1
      read: [a]
      write: [a]
      move: R
      next: q1
    
    - state: q1
      read: [b]
      write: [b]
      move: R
      next: q1
    
    - state: q1
      read: [X]
      write: [X]
      move: R
      next: q1
    
    - state: q1
      read: [Y]
      write: [Y]
      move: R
      next: q1
    
    - state: q1
      read: [Z]
      write: [Z]
      move: R
      next: q1
    
    # Encontrar el final y escribir el símbolo copiado
    - state: q1
      read: [B]
      write: [Z]
      move: R
      next: q2
    
    # Fase 3: Escribir la copia del símbolo marcado
    # Si el símbolo original era 'a' (marcado como X)
    - state: q2
      read: [B]
      write: [a]
      move: L
      next: q3
    
    # Fase 4: Regresar al principio para continuar
    - state: q3
      read: [a]
      write: [a]
      move: L
      next: q3
    
    - state: q3
      read: [b]
      write: [b]
      move: L
      next: q3
    
    - state: q3
      read: [X]
      write: [X]
      move: L
      next: q3
    
    - state: q3
      read: [Y]
      write: [Y]
      move: L
      next: q3
    
    - state: q3
      read: [Z]
      write: [Z]
      move: L
      next: q3
    
    - state: q3
      read: [B]
      write: [B]
      move: R
      next: q0
    
    # Fase 5: Limpiar marcadores y finalizar
    - state: q4
      read: [X]
      write: [a]
      move: R
      next: q4
    
    - state: q4
      read: [Y]
      write: [b]
      move: R
      next: q4
    
    - state: q4
      read: [a]
      write: [a]
      move: R
      next: q4
    
    - state: q4
      read: [b]
      write: [b]
      move: R
      next: q4
    
    - state: q4
      read: [B]
      write: [B]
      move: L
      next: qf
    
    # Transiciones adicionales para manejar el caso donde ya procesamos 'b'
    - state: q2
      read: [a]
      write: [a]
      move: R
      next: q2
    
    - state: q2
      read: [b]
      write: [b]
      move: R
      next: q2
    
  inputs:
    - "ab"           # Resultado esperado: abab
    - "aab"          # Resultado esperado: aabaab
    - "bba"          # Resultado esperado: bbabba
    - "abab"         # Resultado esperado: abababab
    - "aaaa"         # Resultado esperado: aaaaaaaa